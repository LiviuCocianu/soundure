import React, { useEffect, useMemo, useState } from 'react'
import { useSelector } from 'react-redux'

import HorizontalCategory from '../../../general/HorizontalCategory'
import { find, reverse } from '../../../../functions';
import { PlaylistBridge } from '../../../../database/componentBridge';

/**
 * HistoryCategory component
 * 
 * @param {object} props props object
 * @param {object} props.navigation Object generated by React Navigation
 * @param {number} props.maxContent Maximum amount of content to display in the category
 * 
 * @returns {JSX.Element} JSX component
 */
const HistoryCategory = ({
    navigation,
    maxContent = 10
}) => {
    /** 
     * We use the playlists content state here to update the component every time the user
     * listens to a track and it gets added to the history playlist
     * */
    const tracks = useSelector(state => state.tracks);
    const historyOrder = useSelector(state => state.playlistConfig.historyOrder);

    const historyTracks = useMemo(() => {
        return reverse(historyOrder.map(id => find(tracks, "id", id, undefined)).filter(tr => tr != undefined));
    }, [historyOrder, tracks]);

    return (
        <HorizontalCategory 
            navigation={navigation}
            title="Istoricul redÄƒrilor" 
            tracks={historyTracks}
            maxContent={maxContent}/>
    );
};

export default HistoryCategory
